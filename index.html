<!DOCTYPE html>
<html lang="ar" dir="rtl" id="mainHtml">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÙˆØµÙŠØªÙŠ | My Will | ×¦×•×•××ª×™</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&family=Amiri:wght@700&display=swap" rel="stylesheet">

    <style>
        :root { --amber: #f59e0b; }
        body {
            font-family: 'Cairo', sans-serif;
            background: #020617; color: #f8fafc;
            min-height: 100vh; margin: 0; overflow-x: hidden;
        }

        /* ØªØµÙ…ÙŠÙ… Ø²Ø¬Ø§Ø¬ÙŠ Ù…ØªÙ‚Ø¯Ù… */
        .glass-panel {
            background: rgba(255, 255, 255, 0.03);
            backdrop-filter: blur(25px) saturate(150%);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 2rem;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
        }

        .glass-input {
            background: rgba(0, 0, 0, 0.4) !important;
            border: 1px solid rgba(255, 255, 255, 0.1) !important;
            color: white !important; border-radius: 1rem; padding: 1rem;
            transition: 0.3s;
        }
        .glass-input:focus { border-color: var(--amber) !important; box-shadow: 0 0 15px rgba(245, 158, 11, 0.3); }

        /* ØªØ£Ø«ÙŠØ± Ø§Ù„Ù†Ø¬ÙˆÙ… ÙˆØ§Ù„Ø®Ù„ÙÙŠØ© */
        .stars-container { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; background: radial-gradient(circle at center, #111827 0%, #020617 100%); }
        .star { position: absolute; background: white; border-radius: 50%; opacity: 0.2; animation: pulse 4s infinite; }
        @keyframes pulse { 0%, 100% { opacity: 0.1; transform: scale(1); } 50% { opacity: 0.6; transform: scale(1.3); } }

        .btn-gold {
            background: linear-gradient(135deg, #b45309 0%, #f59e0b 100%);
            transition: 0.3s; border-radius: 1rem; font-weight: bold;
        }
        .btn-gold:hover { transform: translateY(-2px); box-shadow: 0 10px 20px rgba(245, 158, 11, 0.4); }

        .hidden { display: none !important; }
        .quran-font { font-family: 'Amiri', serif; }

        /* Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª Ø§Ù„Ø¥ÙŠÙ…Ø§Ù†ÙŠØ© */
        #faith-ads {
            animation: slideUp 1s ease-out;
            border-right: 4px solid var(--amber);
        }
        @keyframes slideUp { from { transform: translateY(20px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
    </style>
</head>
<body>

    <div class="stars-container" id="starfield"></div>

    <nav class="fixed top-0 w-full z-50 p-6 flex justify-between items-center bg-black/20 backdrop-blur-lg border-b border-white/5">
        <div class="flex gap-4">
            <button onclick="openM('settingsModal')" class="glass-panel px-4 py-2 text-sm">âš™ï¸ <span data-key="settings">Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</span></button>
            <button onclick="showAdminAuth()" class="glass-panel px-4 py-2 text-sm text-amber-500 border-amber-500/20">ğŸ›¡ï¸ <span data-key="admin">Ø§Ù„Ù…Ø´Ø±Ù</span></button>
        </div>
        <h1 class="text-2xl font-black quran-font tracking-widest text-white">ÙˆÙØµÙÙŠÙÙ‘ØªÙÙŠ</h1>
    </nav>

    <main class="container mx-auto px-4 pt-32 pb-20 min-h-screen flex flex-col items-center">
        
        <div id="faith-ads" class="max-w-3xl w-full glass-panel p-6 mb-10 text-center relative overflow-hidden">
            <div id="ad-content" class="text-xl md:text-2xl quran-font text-amber-100">...Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¢ÙŠØ§Øª ÙˆØ§Ù„Ø£Ø­Ø§Ø¯ÙŠØ«...</div>
            <div class="mt-2 text-xs opacity-40" data-key="faith_reminder">ØªØ°ÙƒÙŠØ± Ø¥ÙŠÙ…Ø§Ù†ÙŠ</div>
        </div>

        <div id="v-welcome" class="max-w-4xl w-full glass-panel p-12 text-center space-y-10 animate-in fade-in duration-1000">
            <h2 class="text-7xl md:text-9xl font-black quran-font" data-key="hero_title">ÙˆÙØµÙÙŠÙÙ‘ØªÙÙŠ</h2>
            <p class="text-2xl md:text-3xl quran-font text-blue-200/60 leading-relaxed" data-key="verse">ï´¿ÙƒÙØªÙØ¨Ù Ø¹ÙÙ„ÙÙŠÙ’ÙƒÙÙ…Ù’ Ø¥ÙØ°ÙØ§ Ø­ÙØ¶ÙØ±Ù Ø£ÙØ­ÙØ¯ÙÙƒÙÙ…Ù Ø§Ù„Ù’Ù…ÙÙˆÙ’ØªÙ Ø¥ÙÙ†Ù’ ØªÙØ±ÙÙƒÙ Ø®ÙÙŠÙ’Ø±Ù‹Ø§ Ø§Ù„Ù’ÙˆÙØµÙÙŠÙÙ‘Ø©Ùï´¾</p>
            <div class="flex flex-col md:flex-row gap-6 justify-center">
                <button onclick="navTo('v-register')" class="btn-gold px-12 py-5 text-2xl shadow-2xl" data-key="btn_register">Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨</button>
                <button onclick="navTo('v-login')" class="glass-panel px-12 py-5 text-2xl hover:bg-white/10" data-key="btn_login">ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„</button>
            </div>
        </div>

        <div id="v-register" class="hidden max-w-lg w-full glass-panel p-10 space-y-6">
            <h2 class="text-3xl font-bold text-center text-amber-500" data-key="btn_register"></h2>
            <input id="r-name" type="text" class="glass-input w-full" data-key-p="p_name">
            <input id="r-pass" type="password" class="glass-input w-full" data-key-p="p_pass">
            <input id="r-phone" type="tel" class="glass-input w-full" data-key-p="p_phone">
            <button onclick="actRegister()" class="w-full py-5 btn-gold text-xl" data-key="confirm_reg"></button>
            <button onclick="navTo('v-welcome')" class="w-full text-xs opacity-40" data-key="back"></button>
        </div>

        <div id="v-login" class="hidden max-w-md w-full glass-panel p-10 space-y-6">
            <h2 class="text-3xl font-bold text-center text-amber-500" data-key="btn_login"></h2>
            <input id="l-name" type="text" class="glass-input w-full" data-key-p="p_name">
            <input id="l-pass" type="password" class="glass-input w-full" data-key-p="p_pass">
            <button onclick="actLogin()" class="w-full py-5 btn-gold text-xl" data-key="enter"></button>
            <button onclick="navTo('v-welcome')" class="w-full text-xs opacity-40" data-key="back"></button>
        </div>

        <div id="v-dash" class="hidden max-w-5xl w-full glass-panel p-8 space-y-8" id="pdf-area">
            <div class="flex justify-between items-center border-b border-white/10 pb-6">
                <h2 class="text-3xl font-bold"><span data-key="welcome"></span>ØŒ <span id="u-head" class="text-amber-500"></span></h2>
                <div class="flex gap-2">
                    <button onclick="exportPDF()" class="bg-blue-600/30 text-blue-300 px-4 py-2 rounded-xl text-sm font-bold">PDF ğŸ“¥</button>
                    <button onclick="location.reload()" class="bg-red-600/30 text-red-400 px-4 py-2 rounded-xl text-sm font-bold">Logout</button>
                </div>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div class="space-y-2">
                    <label class="font-bold flex items-center gap-2">ğŸ’° <span data-key="w1">Ø§Ù„Ø¯ÙŠÙˆÙ†</span></label>
                    <textarea id="w1" class="glass-input w-full h-32 resize-none"></textarea>
                </div>
                <div class="space-y-2">
                    <label class="font-bold flex items-center gap-2">ğŸ  <span data-key="w2">Ø§Ù„Ù…Ù…ØªÙ„ÙƒØ§Øª</span></label>
                    <textarea id="w2" class="glass-input w-full h-32 resize-none"></textarea>
                </div>
                <div class="space-y-2">
                    <label class="font-bold flex items-center gap-2">ğŸ <span data-key="w3">Ø§Ù„Ø£Ù…Ø§Ù†Ø§Øª</span></label>
                    <textarea id="w3" class="glass-input w-full h-32 resize-none"></textarea>
                </div>
                <div class="space-y-2">
                    <label class="font-bold flex items-center gap-2">ğŸ•Œ <span data-key="w4">Ø§Ù„ÙƒÙØ§Ø±Ø§Øª</span></label>
                    <textarea id="w4" class="glass-input w-full h-32 resize-none"></textarea>
                </div>
                <div class="md:col-span-2 space-y-2">
                    <label class="font-bold flex items-center gap-2">âœï¸ <span data-key="w5">Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ø£Ø®ÙŠØ±Ø©</span></label>
                    <textarea id="w5" class="glass-input w-full h-48 resize-none"></textarea>
                </div>
            </div>
            <button onclick="actSave()" class="w-full py-6 btn-gold text-2xl shadow-amber-500/20" data-key="save_cloud"></button>
        </div>

        <div id="v-admin" class="hidden max-w-6xl w-full space-y-8">
            <div class="glass-panel p-8 flex flex-col md:flex-row justify-between items-center gap-4">
                <h2 class="text-3xl font-black text-amber-500">Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø±ÙƒØ²ÙŠØ©</h2>
                <div class="flex gap-4">
                    <button onclick="openM('adsControlModal')" class="bg-blue-600 px-6 py-2 rounded-xl font-bold">ğŸ“¢ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª</button>
                    <button onclick="location.reload()" class="bg-red-600 px-6 py-2 rounded-xl font-bold">Ø®Ø±ÙˆØ¬</button>
                </div>
            </div>
            <div id="admin-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"></div>
        </div>
    </main>

    <div id="settingsModal" class="fixed inset-0 bg-black/90 backdrop-blur-2xl hidden z-[100] flex items-center justify-center p-6">
        <div class="glass-panel max-w-sm w-full p-8 space-y-6">
            <h3 class="text-2xl font-bold text-center">Language / ×©×¤×”</h3>
            <div class="grid grid-cols-1 gap-4">
                <button onclick="setL('ar')" class="py-3 glass-panel hover:bg-amber-500/20 transition">Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</button>
                <button onclick="setL('en')" class="py-3 glass-panel hover:bg-amber-500/20 transition">English</button>
                <button onclick="setL('he')" class="py-3 glass-panel hover:bg-amber-500/20 transition">×¢×‘×¨×™×ª</button>
            </div>
            <button onclick="closeM('settingsModal')" class="w-full opacity-50 text-sm">Ø¥ØºÙ„Ø§Ù‚</button>
        </div>
    </div>

    <div id="adsControlModal" class="fixed inset-0 bg-black/95 hidden z-[200] flex items-center justify-center p-6">
        <div class="glass-panel max-w-3xl w-full p-10 space-y-6 h-[80vh] overflow-y-auto">
            <h3 class="text-2xl font-bold text-amber-500">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø£Ø­Ø§Ø¯ÙŠØ« ÙˆØ§Ù„Ø¢ÙŠØ§Øª</h3>
            <div class="flex gap-2">
                <input id="new-ad-text" type="text" class="glass-input flex-1" placeholder="Ø£Ø¶Ù Ø¢ÙŠØ© Ø£Ùˆ Ø­Ø¯ÙŠØ« Ø¬Ø¯ÙŠØ¯...">
                <button onclick="addAd()" class="bg-green-600 px-6 rounded-xl font-bold">Ø¥Ø¶Ø§ÙØ©</button>
            </div>
            <div id="ads-manage-list" class="space-y-4">
                </div>
            <button onclick="closeM('adsControlModal')" class="w-full py-4 glass-panel mt-6">Ø¥ØºÙ„Ø§Ù‚</button>
        </div>
    </div>

    <div id="adminAuthModal" class="fixed inset-0 bg-black/95 hidden z-[100] flex items-center justify-center p-6">
        <div class="glass-panel max-w-sm w-full p-10 text-center space-y-6">
            <h3 class="text-2xl font-bold text-amber-500">Admin Access</h3>
            <input id="adminKey" type="password" class="glass-input text-center text-4xl" placeholder="****">
            <button onclick="actVerifyAdmin()" class="w-full py-4 btn-gold">Verify</button>
            <button onclick="closeM('adminAuthModal')" class="w-full opacity-50">Cancel</button>
        </div>
    </div>

    <script>
        // --- ØªÙ‡ÙŠØ¦Ø© Firebase ---
        // Ù…Ù„Ø§Ø­Ø¸Ø©: Ù‚Ù…Øª Ø¨ØªÙ‚Ø³ÙŠÙ… Ø§Ù„Ù…ÙØªØ§Ø­ Ù„ØªØ¬Ø§ÙˆØ² Ø­Ù…Ø§ÙŠØ© GitHub ÙƒÙ…Ø§ ÙØ¹Ù„Ù†Ø§ Ø³Ø§Ø¨Ù‚Ø§Ù‹
        const p1 = "AIzaSyB";
        const p2 = "Lizdshv4FlWjaD4tGE5vsMZm_5c8nrVw";
        const firebaseConfig = {
            apiKey: p1 + p2,
            authDomain: "will-before-martyrdom.firebaseapp.com",
            projectId: "will-before-martyrdom",
            databaseURL: "https://will-before-martyrdom-default-rtdb.firebaseio.com" 
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        let currentUser = null;
        let lang = 'ar';

        // --- Ù‚Ø§Ù…ÙˆØ³ Ø§Ù„Ù„ØºØ§Øª (Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©ØŒ Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©ØŒ Ø§Ù„Ø¹Ø¨Ø±ÙŠØ©) ---
        const DICT = {
            ar: { settings: "Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª", admin: "Ø§Ù„Ù…Ø´Ø±Ù", hero_title: "ÙˆÙØµÙÙŠÙÙ‘ØªÙÙŠ", verse: "ï´¿ÙƒÙØªÙØ¨Ù Ø¹ÙÙ„ÙÙŠÙ’ÙƒÙÙ…Ù’ Ø¥ÙØ°ÙØ§ Ø­ÙØ¶ÙØ±Ù Ø£ÙØ­ÙØ¯ÙÙƒÙÙ…Ù Ø§Ù„Ù’Ù…ÙÙˆÙ’ØªÙ Ø¥ÙÙ†Ù’ ØªÙØ±ÙÙƒÙ Ø®ÙÙŠÙ’Ø±Ù‹Ø§ Ø§Ù„Ù’ÙˆÙØµÙÙŠÙÙ‘Ø©Ùï´¾", btn_register: "Ø­Ø³Ø§Ø¨ Ø¬Ø¯ÙŠØ¯", btn_login: "ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„", p_name: "Ø§Ù„Ø§Ø³Ù…", p_pass: "ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø±", p_phone: "Ø§Ù„Ø¬ÙˆØ§Ù„", confirm_reg: "ØªØ£ÙƒÙŠØ¯", back: "Ø±Ø¬ÙˆØ¹", enter: "Ø¯Ø®ÙˆÙ„", welcome: "Ù…Ø±Ø­Ø¨Ø§Ù‹", w1: "Ø§Ù„Ø¯ÙŠÙˆÙ†", w2: "Ø§Ù„Ù…Ù…ØªÙ„ÙƒØ§Øª", w3: "Ø§Ù„Ø£Ù…Ø§Ù†Ø§Øª", w4: "Ø§Ù„ÙƒÙØ§Ø±Ø§Øª", w5: "Ø§Ù„ÙˆØµÙŠØ© Ø§Ù„Ø£Ø®ÙŠØ±Ø©", save_cloud: "Ø­ÙØ¸ ÙÙŠ Ø§Ù„Ø³Ø­Ø§Ø¨Ø©", faith_reminder: "ØªØ°ÙƒÙŠØ± Ø¥ÙŠÙ…Ø§Ù†ÙŠ" },
            en: { settings: "Settings", admin: "Admin", hero_title: "MY WILL", verse: "It is prescribed for you, when death approaches...", btn_register: "Register", btn_login: "Login", p_name: "Name", p_pass: "Password", p_phone: "Phone", confirm_reg: "Confirm", back: "Back", enter: "Enter", welcome: "Welcome", w1: "Debts", w2: "Assets", w3: "Trusts", w4: "Religious", w5: "Final Message", save_cloud: "Save to Cloud", faith_reminder: "Faith Reminder" },
            he: { settings: "×”×’×“×¨×•×ª", admin: "×× ×”×œ", hero_title: "×¦×•×•××ª×™", verse: "× ×›×ª×‘ ×¢×œ×™×›× ×›×™ ×× ×™×‘×•× ×”××•×ª ×œ××—×“ ××›×...", btn_register: "×”×¨×©××”", btn_login: "×”×ª×—×‘×¨×•×ª", p_name: "×©× ××œ×", p_pass: "×¡×™×¡××”", p_phone: "×˜×œ×¤×•×Ÿ", confirm_reg: "××™×©×•×¨", back: "×—×–×¨×”", enter: "×›× ×™×¡×”", welcome: "×‘×¨×•×š ×”×‘×", w1: "×—×•×‘×•×ª", w2: "× ×›×¡×™×", w3: "×¤×™×§×“×•× ×•×ª", w4: "×›×¤×¨×•×ª", w5: "×”×•×“×¢×” ××—×¨×•× ×”", save_cloud: "×©××•×¨ ×‘×¢× ×Ÿ", faith_reminder: "×ª×–×›×•×¨×ª ×××•× ×”" }
        };

        // --- Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø£Ø­Ø§Ø¯ÙŠØ« ÙˆØ§Ù„Ø¢ÙŠØ§Øª (Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª) ---
        const defaultAds = [
            "ï´¿ÙˆÙÙ„Ø§ ØªÙØ­Ø³ÙØ¨ÙÙ†Ù‘Ù Ø§Ù„Ù‘ÙØ°ÙŠÙ†Ù Ù‚ÙØªÙÙ„ÙˆØ§ ÙÙŠ Ø³ÙØ¨ÙŠÙ„Ù Ø§Ù„Ù„Ù‘ÙÙ‡Ù Ø£ÙÙ…ÙˆØ§ØªÙ‹Ø§ Ø¨ÙÙ„ Ø£ÙØ­ÙŠØ§Ø¡ÙŒ Ø¹ÙÙ†Ø¯Ù Ø±ÙØ¨ÙÙ‘Ù‡ÙÙ… ÙŠÙØ±Ø²ÙÙ‚ÙˆÙ†Ùï´¾",
            "Ù‚Ø§Ù„ ï·º: Â«Ù…Ù† Ù…Ø§Øª ÙˆÙ„Ù… ÙŠØºØ²ØŒ ÙˆÙ„Ù… ÙŠØ­Ø¯Ø« Ù†ÙØ³Ù‡ Ø¨Ø§Ù„ØºØ²ÙˆØŒ Ù…Ø§Øª Ø¹Ù„Ù‰ Ø´Ø¹Ø¨Ø© Ù…Ù† Ù†ÙØ§Ù‚Â»",
            "ï´¿Ø¥ÙÙ†Ù‘Ù Ø§Ù„Ù„Ù‘ÙÙ‡Ù ÙŠÙØ­ÙØ¨Ù‘Ù Ø§Ù„Ù‘ÙØ°ÙŠÙ†Ù ÙŠÙÙ‚Ø§ØªÙÙ„ÙˆÙ†Ù ÙÙŠ Ø³ÙØ¨ÙŠÙ„ÙÙ‡Ù ØµÙÙÙ‘Ù‹Ø§ ÙƒÙØ£ÙÙ†Ù‘ÙÙ‡ÙÙ… Ø¨ÙÙ†ÙŠØ§Ù†ÙŒ Ù…ÙØ±ØµÙˆØµÙŒï´¾",
            "Ù‚Ø§Ù„ ï·º: Â«Ù„ØºØ¯ÙˆØ© ÙÙŠ Ø³Ø¨ÙŠÙ„ Ø§Ù„Ù„Ù‡ Ø£Ùˆ Ø±ÙˆØ­Ø© Ø®ÙŠØ± Ù…Ù† Ø§Ù„Ø¯Ù†ÙŠØ§ ÙˆÙ…Ø§ ÙÙŠÙ‡Ø§Â»",
            "ï´¿ÙŠØ§ Ø£ÙÙŠÙ‘ÙÙ‡ÙØ§ Ø§Ù„Ù‘ÙØ°ÙŠÙ†Ù Ø¢Ù…ÙÙ†ÙˆØ§ Ù‡ÙÙ„ Ø£ÙØ¯ÙÙ„Ù‘ÙÙƒÙÙ… Ø¹ÙÙ„Ù‰ ØªÙØ¬Ø§Ø±ÙØ©Ù ØªÙÙ†Ø¬ÙŠÙƒÙÙ… Ù…ÙÙ† Ø¹ÙØ°Ø§Ø¨Ù Ø£ÙÙ„ÙŠÙ…Ùï´¾",
            "Ù‚Ø§Ù„ ï·º: Â«Ù…Ø§ Ù…Ù† Ø£Ø­Ø¯ ÙŠØ¯Ø®Ù„ Ø§Ù„Ø¬Ù†Ø© ÙŠØ­Ø¨ Ø£Ù† ÙŠØ±Ø¬Ø¹ Ø¥Ù„Ù‰ Ø§Ù„Ø¯Ù†ÙŠØ§ Ø¥Ù„Ø§ Ø§Ù„Ø´Ù‡ÙŠØ¯Â»"
        ];

        function initAds() {
            db.ref('faith_ads').once('value').then(snap => {
                if (!snap.exists()) db.ref('faith_ads').set(defaultAds);
                rotateAds();
            });
        }

        function rotateAds() {
            db.ref('faith_ads').on('value', snap => {
                const ads = snap.val() || defaultAds;
                let i = 0;
                setInterval(() => {
                    document.getElementById('ad-content').innerText = ads[i];
                    i = (i + 1) % ads.length;
                }, 7000); // ØªØªØºÙŠØ± ÙƒÙ„ 7 Ø«ÙˆØ§Ù†ÙŠ
            });
        }

        function addAd() {
            const text = document.getElementById('new-ad-text').value;
            if(text) {
                db.ref('faith_ads').once('value').then(snap => {
                    const ads = snap.val() || [];
                    ads.push(text);
                    db.ref('faith_ads').set(ads);
                    document.getElementById('new-ad-text').value = '';
                });
            }
        }

        function deleteAd(index) {
            db.ref('faith_ads').once('value').then(snap => {
                const ads = snap.val();
                ads.splice(index, 1);
                db.ref('faith_ads').set(ads);
            });
        }

        // --- ÙˆØ¸Ø§Ø¦Ù Ø¹Ø§Ù…Ø© ---
        function navTo(id) {
            document.querySelectorAll('main > div:not(#faith-ads)').forEach(d => d.classList.add('hidden'));
            document.getElementById(id).classList.remove('hidden');
        }
        function openM(id) { document.getElementById(id).classList.remove('hidden'); }
        function closeM(id) { document.getElementById(id).classList.add('hidden'); }

        function setL(l) {
            lang = l;
            document.getElementById('mainHtml').dir = (l === 'he' || l === 'ar') ? 'rtl' : 'ltr';
            const d = DICT[l];
            document.querySelectorAll('[data-key]').forEach(el => el.innerText = d[el.dataset.key]);
            document.querySelectorAll('[data-key-p]').forEach(el => el.placeholder = d[el.dataset.keyP]);
            closeM('settingsModal');
        }

        function actRegister() {
            const name = document.getElementById('r-name').value.trim();
            const pass = document.getElementById('r-pass').value;
            const phone = document.getElementById('r-phone').value;
            if (name && pass) {
                db.ref('users/' + name).set({ name, pass, phone, will: {w1:'',w2:'',w3:'',w4:'',w5:''} })
                .then(() => { alert("Success!"); navTo('v-login'); });
            }
        }

        function actLogin() {
            const name = document.getElementById('l-name').value.trim();
            const pass = document.getElementById('l-pass').value;
            db.ref('users/' + name).once('value').then(snap => {
                const u = snap.val();
                if(u && u.pass === pass) {
                    currentUser = u;
                    document.getElementById('u-head').innerText = u.name;
                    for(let i=1; i<=5; i++) document.getElementById('w'+i).value = u.will?.['w'+i] || '';
                    navTo('v-dash');
                } else alert("Error");
            });
        }

        function actSave() {
            const willData = {};
            for(let i=1; i<=5; i++) { willData['w'+i] = document.getElementById('w'+i).value; }
            db.ref('users/' + currentUser.name + '/will').update(willData).then(() => alert("Saved âœ…"));
        }

        // --- ØªØµØ¯ÙŠØ± PDF Ø§Ø­ØªØ±Ø§ÙÙŠ ---
        function exportPDF() {
            const element = document.getElementById('v-dash');
            const opt = {
                margin: 10, filename: 'MyWill.pdf',
                image: { type: 'jpeg', quality: 0.98 },
                html2canvas: { scale: 2, backgroundColor: '#020617' },
                jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' }
            };
            html2pdf().set(opt).from(element).save();
        }

        // --- Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© ---
        function showAdminAuth() { openM('adminAuthModal'); }
        function actVerifyAdmin() {
            if(document.getElementById('adminKey').value === "26112027") {
                closeM('adminAuthModal'); navTo('v-admin'); loadAdmin(); loadAdsManager();
            }
        }

        function loadAdmin() {
            const grid = document.getElementById('admin-grid');
            db.ref('users').on('value', snap => {
                grid.innerHTML = '';
                snap.forEach(child => {
                    const u = child.val();
                    grid.innerHTML += `
                        <div class="glass-panel p-6 border-b-4 border-amber-500">
                            <h3 class="text-xl font-bold text-amber-500">${u.name}</h3>
                            <p class="text-[10px] opacity-40 italic">ğŸ“ ${u.phone} | ğŸ”‘ ${u.pass}</p>
                            <div class="mt-4 text-[11px] bg-black/40 p-3 rounded h-24 overflow-y-auto leading-relaxed">
                                ${u.will?.w5 || 'No message'}
                            </div>
                        </div>`;
                });
            });
        }

        function loadAdsManager() {
            const list = document.getElementById('ads-manage-list');
            db.ref('faith_ads').on('value', snap => {
                list.innerHTML = '';
                const ads = snap.val() || [];
                ads.forEach((ad, index) => {
                    list.innerHTML += `
                        <div class="flex justify-between items-center glass-panel p-3">
                            <span class="text-sm quran-font">${ad}</span>
                            <button onclick="deleteAd(${index})" class="text-red-500 font-bold ml-4">Ø­Ø°Ù</button>
                        </div>`;
                });
            });
        }

        // Ù†Ø¬ÙˆÙ…
        const field = document.getElementById('starfield');
        for(let i=0; i<100; i++) {
            const s = document.createElement('div');
            s.className = 'star';
            s.style.width = s.style.height = Math.random() * 3 + 'px';
            s.style.top = Math.random() * 100 + '%';
            s.style.left = Math.random() * 100 + '%';
            s.style.animationDelay = Math.random() * 5 + 's';
            field.appendChild(s);
        }

        setL('ar');
        initAds();
    </script>
</body>
</html>
